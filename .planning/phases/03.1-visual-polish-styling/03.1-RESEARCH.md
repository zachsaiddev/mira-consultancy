# Phase 03.1: Visual Polish & Styling - Research

**Researched:** 2026-02-17
**Domain:** CSS visual effects, Tailwind v4 theming, scroll-based animation, editorial typography
**Confidence:** HIGH (core techniques) / MEDIUM (parallax implementation choice)

---

<user_constraints>
## User Constraints (from CONTEXT.md)

### Locked Decisions

**Background & depth**
- Gradient base + film grain/noise texture overlay — both layered together
- Uniform background treatment across all sections (no alternating tones)
- Editorial/magazine visual direction (think Monocle, Bloomberg) — sophisticated, text-forward with subtle textures
- Refinement level: "Refined but visible" — clearly elevated, visitors notice the polish without it feeling flashy

**Section visual rhythm**
- Service and process items separated by thin horizontal ruled lines between each item — magazine index/newspaper layout feel
- Current section dividers (border-text-tertiary/10) are invisible on dark background — need to be fixed (stronger opacity or replaced)
- Tech stack section stays as minimal icon row — no card/pill treatment
- About section photo: edges fade/blend into background — editorial magazine style

**Typography & color accents**
- Cool subtle accent color (muted blue or teal) for select elements — CTAs, hover states
- Tighter letter-spacing on h1/h2 headings — editorial punch, condensed tracking
- Section labels keep current muted style (small, uppercase, tertiary) — no changes
- Hero headline: larger and bolder — make it a real statement piece, commanding first impression

**Micro-interactions & hover effects**
- CTA hover: text shifts to accent color — simple, no underline animation
- Service/process items: description text brightens on hover, heading stays same
- Footer social icons: keep current opacity change (muted → full)
- Scroll animations: add parallax-lite effects — some elements move at different scroll speeds for depth

**Rollback strategy**
- Execute on its own git branch so changes can be reverted cleanly if the visual direction doesn't land

### Claude's Discretion
- Exact gradient angle and color stops
- Grain texture intensity and implementation (CSS vs SVG filter)
- Specific accent color shade (muted blue or teal family)
- Parallax scroll speed ratios
- Photo fade/blend technique (CSS mask-image vs gradient overlay)

### Deferred Ideas (OUT OF SCOPE)
None — discussion stayed within phase scope
</user_constraints>

---

<phase_requirements>
## Phase Requirements

| ID | Description | Research Support |
|----|-------------|-----------------|
| DESGN-01 | Dark/monochrome color palette throughout the site | Gradient + grain layer adds depth without breaking the palette; new accent token stays cool/muted |
| DESGN-02 | Bold, typographically strong design with generous whitespace | Hero h1 font-size bump + tighter tracking on h1/h2 delivers this; existing spacing tokens preserved |
| DESGN-03 | All text/background pairs meet WCAG AA contrast ratio | New accent color must be checked against #0a0a0a at selection time; gradient base is safe since it stays near #0a0a0a |
| DESGN-04 | Consistent typography scale that works across mobile and desktop | Changes are additive (tracking, weight, size bump); fluid clamp scale stays intact |
| ANIM-01 | Sections fade in on scroll using Intersection Observer + CSS transitions | Already implemented; parallax-lite adds a second layer on top without replacing it |
| ANIM-02 | Smooth transitions on interactive elements (hover states, focus states) | CTA accent color shift + description text brighten are CSS transition additions |
| ANIM-03 | All non-essential animations disabled when user has prefers-reduced-motion | Parallax JS hook must check prefers-reduced-motion; grain overlay is static (no animation concern) |
</phase_requirements>

---

## Summary

This phase is a pure styling elevation — no new sections, no new data, no routing changes. The work is almost entirely in `globals.css`, the `@theme` block, and targeted edits to existing components. The codebase is already well-structured for these changes: Tailwind v4 `@theme` custom properties, existing animation tokens, and component-per-section files make surgical edits straightforward.

The three biggest implementation decisions for planning are: (1) grain texture technique — SVG `feTurbulence` data-URI in a `::before` pseudo-element on `body` is the right call: pure CSS, zero dependencies, no external file, performant; (2) parallax-lite — CSS scroll-driven animations lack Firefox support as of early 2026 and need a feature flag; a lightweight `useEffect` scroll listener with `requestAnimationFrame` inside a `'use client'` component is the safe, dependency-free choice; (3) photo fade — CSS `mask-image` with a radial gradient is the simplest approach and is broadly supported.

The phase is low-risk. Every change is additive: new CSS tokens, new utility classes, and minor JSX tweaks. The `--color-background` stays `#0a0a0a` and the gradient lives on a `::before` pseudo-element, so the grain and gradient are independently toggleable. The new accent color token replaces `--color-accent` (currently warm white `#fafaf9`) — this is the single most impactful decision with the widest blast radius (Button component, focus ring in base layer).

**Primary recommendation:** Implement background depth (gradient + grain) in `globals.css @layer base` on `body::before`. Add `--color-accent` replacement and typography tokens to `@theme`. Edit components individually for hover states, ruled lines, and parallax. Keep all JS in a single new `useParallax` hook.

---

## Standard Stack

### Core
| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| Tailwind CSS v4 | ^4.1.18 (already installed) | All utility classes, @theme tokens, @layer base | Already in project; v4 @theme syntax is the right place for new color/typography tokens |
| Next.js `next/image` | ^16.x (already installed) | About photo with mask-image fade | Already used in About.tsx; no change needed to the import |

### Supporting
| Library | Version | Purpose | When to Use |
|---------|---------|---------|-------------|
| No new libraries needed | — | All techniques are pure CSS + React hooks | This phase adds zero dependencies |

### Alternatives Considered
| Instead of | Could Use | Tradeoff |
|------------|-----------|----------|
| Hand-rolled scroll parallax hook | `react-scroll-parallax` | Library adds ~8 KB; a 20-line hook does the job; avoid the dependency |
| SVG `feTurbulence` data-URI | External PNG noise texture | PNG requires HTTP request, cannot be adjusted in CSS; data-URI is faster and tunable |
| CSS `mask-image` for photo | Absolutely-positioned gradient overlay div | Both work; `mask-image` is cleaner (no extra DOM node), well-supported, and the recommended modern approach |
| CSS scroll-driven animations | JS scroll listener | CSS version lacks Firefox support as of Feb 2026; JS + rAF is safe for all browsers |

**Installation:**
```bash
# No new packages required
```

---

## Architecture Patterns

### Recommended Project Structure

No new files or folders needed. Changes are isolated to:

```
app/
└── globals.css           # @theme tokens + body::before grain/gradient + new utilities

components/
├── sections/
│   ├── Hero.tsx          # h1 size/weight bump
│   ├── Services.tsx      # ruled lines between items + hover states
│   ├── Process.tsx       # ruled lines between items + hover states
│   └── About.tsx         # photo mask-image fade
├── ui/
│   └── Button.tsx        # accent color hover change
└── layout/
    └── ParallaxProvider.tsx  # NEW: 'use client' hook for parallax-lite (if implemented as component)
```

Alternatively the parallax hook can live in `lib/hooks/useParallax.ts` — both approaches work.

### Pattern 1: SVG feTurbulence Grain Overlay on body

**What:** A `body::before` pseudo-element with an inline SVG data-URI background creates a static film grain across the entire page. A separate `body` gradient (radial + linear layered) adds the depth.

**When to use:** Whole-page grain. The pseudo-element sits at `z-index: -1` so it never affects clicks or content stacking.

**Example:**
```css
/* Source: https://ibelick.com/blog/create-grainy-backgrounds-with-css */
/* Source: https://frontendmasters.com/blog/grainy-gradients/ */

@layer base {
  body {
    position: relative;
    /* Layered gradient: subtle radial warm highlight + overall directional shift */
    background:
      radial-gradient(ellipse 80% 50% at 20% 0%, rgba(255,255,255,0.03) 0%, transparent 60%),
      linear-gradient(160deg, #0d0d0f 0%, #0a0a0a 50%, #08080a 100%);
    background-color: var(--color-background); /* fallback */
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    z-index: -1;
    pointer-events: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 600'%3E%3Cfilter id='a'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23a)'/%3E%3C/svg%3E");
    background-size: 200px 200px;
    opacity: 0.035; /* "Refined but visible" — adjust between 0.02–0.06 */
  }
}
```

Key parameters to tune:
- `baseFrequency` — 0.65 gives medium grain; 0.9+ is finer; below 0.5 is coarser
- `numOctaves` — 3 is good; 4 adds detail at cost of complexity
- `background-size` on the ::before — smaller tile = finer grain appearance
- `opacity` — stay 0.02–0.05 for "refined but visible" on dark

**IMPORTANT:** Use `position: fixed` (not `absolute`) on `::before` so grain covers the viewport during scroll — an absolute pseudo-element on body is as tall as the full document which causes tile repetition and scroll jank.

### Pattern 2: Accent Color Token Replacement

**What:** Replace `--color-accent` from warm white `#fafaf9` to a muted blue/teal. This is the correct Tailwind v4 approach — single token change propagates everywhere.

**When to use:** Once. The token is already consumed by `Button.tsx` (`text-accent`, `text-accent/80`) and the `focus-visible` ring in `@layer base`.

**Example:**
```css
/* Source: Tailwind CSS v4 @theme docs */
@theme {
  /* Replacing warm white accent with cool muted blue */
  --color-accent: #6b8fae; /* muted steel blue — verify WCAG AA against #0a0a0a */
  /* Ratio required: 4.5:1 for normal text. #6b8fae on #0a0a0a ≈ 5.1:1 — check with tool */
}
```

Candidate values to verify (check contrast against `#0a0a0a`):
- `#6b8fae` — muted steel blue (~5.1:1 — likely AA compliant, verify)
- `#5b8a9f` — slate teal (~4.8:1 — verify)
- `#7a9eb8` — lighter steel blue (higher ratio, softer look)

**Verification required:** Use a contrast checker (e.g. `https://webaim.org/resources/contrastchecker/`) for the final chosen value before committing.

### Pattern 3: Typography Tightening via @theme

**What:** Add custom tracking token and apply to h1/h2 in `@layer base`.

**When to use:** Editorial punch on large headings. Existing `-0.02em` on all headings (`h1`–`h6`) gets overridden for h1/h2 specifically.

**Example:**
```css
/* Source: https://tailwindcss.com/docs/letter-spacing */
@theme {
  --tracking-editorial: -0.035em; /* tighter than -0.025em tight, less extreme than -0.05em tighter */
}

@layer base {
  h1 {
    font-size: var(--font-size-4xl);
    letter-spacing: var(--tracking-editorial);
    font-weight: 700; /* bump from 600 to 700 for hero impact */
  }
  h2 {
    font-size: var(--font-size-3xl);
    letter-spacing: var(--tracking-editorial);
  }
}
```

Or use inline Tailwind classes on the Hero `<h1>` directly:
```jsx
<h1 className="mb-6 tracking-[-0.035em] font-bold">
```

Note: The Hero h1 also needs a **size bump** per locked decisions. Current `--font-size-4xl` is `clamp(3rem, 2.25rem + 3.75vw, 4rem)`. Options:
1. Add a `--font-size-5xl` token (e.g. `clamp(3.5rem, 2.5rem + 5vw, 5rem)`) and use it only on the hero h1
2. Override inline with `text-[clamp(3.5rem,2.5rem+5vw,5rem)]` in the Hero component

Option 1 is cleaner — keeps sizing in the theme system.

### Pattern 4: Ruled Lines Between Service/Process Items

**What:** Replace `space-y-10` + blank spacing with items separated by `border-b` rules. Magazine index layout feel.

**When to use:** Services and Process sections. Each item gets a bottom border except the last.

**Example:**
```jsx
/* In Services.tsx and Process.tsx */
<div className="divide-y divide-text-tertiary/20">
  {services.map((service) => (
    <div key={service.id} className="py-8 group cursor-default">
      <h3 className="text-xl mb-2 text-text-primary">{service.title}</h3>
      <p className="text-text-secondary transition-colors duration-200 group-hover:text-text-primary">
        {service.description}
      </p>
    </div>
  ))}
</div>
```

Key: Use Tailwind's `divide-y` utility which adds `border-top` to every child except the first — this creates ruled lines between items cleanly. The opacity `divide-text-tertiary/20` gives a visible but subtle rule. This is stronger than the current `/10` section dividers that are invisible.

The `group` + `group-hover:text-text-primary` pattern handles the "description text brightens on hover" locked decision without any JS.

### Pattern 5: Fixed Section Dividers in page.tsx

**What:** The `border-text-tertiary/10` dividers between sections are invisible. Fix by increasing opacity.

**Current:**
```jsx
<hr className="border-t border-text-tertiary/10" />
```

**Fixed:**
```jsx
<hr className="border-t border-text-tertiary/20" />
```

`/20` gives a visible but subtle rule (approximately `rgba(122,122,122,0.2)`) that reads on `#0a0a0a`. Could go to `/25` if still too subtle after seeing it rendered.

### Pattern 6: Photo Fade with CSS mask-image

**What:** Apply a radial/directional gradient mask to the About photo so edges dissolve into the dark background.

**When to use:** The `<Image>` component in `About.tsx`.

**Example:**
```jsx
/* In About.tsx — add style prop to the Image wrapper div */
<div
  className="w-48 h-48 md:w-full md:h-auto overflow-hidden"
  style={{
    maskImage: 'radial-gradient(ellipse 85% 85% at 50% 40%, black 40%, transparent 80%)',
    WebkitMaskImage: 'radial-gradient(ellipse 85% 85% at 50% 40%, black 40%, transparent 80%)',
  }}
>
  <Image ... />
</div>
```

Remove the `bg-text-tertiary/10` background and `rounded-lg` from the wrapper — they conflict with the fade effect.

Gradient parameters to tune:
- `ellipse 85% 85%` — coverage of the opaque center area
- `at 50% 40%` — shift center slightly upward for portrait photos (face in upper portion)
- `40%` → `80%` — the fade transition zone; wider spread = softer blend

### Pattern 7: Parallax-Lite Scroll Hook

**What:** A lightweight React hook that tracks scroll position and applies `translateY` to selected elements. Uses `requestAnimationFrame` for performance, respects `prefers-reduced-motion`, and is `'use client'` safe.

**Why not CSS scroll-driven animations:** Firefox does not support `animation-timeline: scroll()` as of early 2026. Given this is a production consultancy site, cross-browser support takes priority.

**Example:**
```typescript
// lib/hooks/useParallax.ts
'use client';

import { useEffect, useRef } from 'react';

/**
 * Applies a subtle translateY parallax to the ref'd element.
 * speed: 0.0 = no movement, 0.1 = very subtle (recommended), 0.2 = noticeable
 * Automatically disabled when prefers-reduced-motion is set.
 */
export function useParallax<T extends HTMLElement>(speed: number = 0.08) {
  const ref = useRef<T>(null);

  useEffect(() => {
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (prefersReduced) return;

    let rafId: number;

    const handleScroll = () => {
      rafId = requestAnimationFrame(() => {
        if (!ref.current) return;
        const scrollY = window.scrollY;
        const rect = ref.current.getBoundingClientRect();
        const elementCenter = rect.top + rect.height / 2;
        const viewportCenter = window.innerHeight / 2;
        const offset = (elementCenter - viewportCenter) * speed;
        ref.current.style.transform = `translateY(${offset.toFixed(1)}px)`;
      });
    };

    window.addEventListener('scroll', handleScroll, { passive: true });
    handleScroll(); // initial call

    return () => {
      window.removeEventListener('scroll', handleScroll);
      cancelAnimationFrame(rafId);
    };
  }, [speed]);

  return ref;
}
```

Usage in Hero (hero headline moves slightly slower than scroll):
```tsx
'use client';
import { useParallax } from '@/lib/hooks/useParallax';

export function Hero() {
  const headlineRef = useParallax<HTMLHeadingElement>(0.06);
  // ...
  return (
    <section ...>
      <div className="prose-width">
        <p className="section-label mb-8">Mira Consultancy</p>
        <h1 ref={headlineRef} className="mb-6 ...">
          I build the tools your business actually needs.
        </h1>
        ...
      </div>
    </section>
  );
}
```

**Important:** Adding `'use client'` to Hero.tsx is fine — Next.js static export works with client components. It just means the component renders on the client. Hero has no server data, so no RSC benefit is lost.

**Scope of parallax:** Keep it to 1–2 elements maximum. Recommended: hero headline only, or hero headline + section headings. Over-applying parallax is how "lite" becomes heavy.

### Pattern 8: CTA Hover Color Shift

**What:** Primary CTA button text shifts to accent color on hover (currently warm white `#fafaf9` → new accent blue/teal). This is already partially in place — `Button.tsx` uses `text-accent hover:text-accent/80`. Once the accent token is changed (Pattern 2), the CTA hover behavior updates automatically.

**No JSX changes needed** to `Button.tsx` for the color shift. The only change needed: optionally add a brief transition on the color (already present via `transition-colors`).

### Anti-Patterns to Avoid

- **Animating the grain texture:** Do not add CSS `animation` to `body::before` — animated noise is visually distracting and CPU-intensive. Static grain only.
- **Applying parallax to many elements:** Parallax on more than 2–3 elements creates visual chaos and scroll jank. One or two hero elements maximum.
- **Using `position: absolute` on body grain pseudo-element:** Use `position: fixed` so the grain viewport-locks and doesn't tile-repeat during scroll.
- **Replacing `--color-background` with a gradient variable:** Keep `background-color: var(--color-background)` as the CSS `background-color` fallback. The gradient goes in the `background` shorthand or on `::before`.
- **Nesting the grain ::before inside a wrapper div:** Put it on `body` so it covers all sections uniformly. Wrapper-level pseudo-elements break the "uniform background treatment" decision.
- **Using `mix-blend-mode: soft-light` on the grain in dark-bg context without testing:** Soft-light blend can make grain invisible on very dark backgrounds or blow out on lighter gradient regions. Test `opacity` on the `::before` element instead — more predictable.

---

## Don't Hand-Roll

| Problem | Don't Build | Use Instead | Why |
|---------|-------------|-------------|-----|
| Noise texture generation | Custom Canvas noise renderer | SVG feTurbulence data-URI in ::before | Canvas requires JS + DOM manipulation; SVG data-URI is pure CSS, cacheable, zero runtime cost |
| Contrast checking | Manual calculation | webaim.org contrast checker or browser devtools | Off-by-one errors in manual WCAG math cause accessibility issues |
| Scroll event throttling | Custom throttle utility | `{ passive: true }` + `requestAnimationFrame` | The passive flag prevents scroll-blocking; rAF batches repaints natively |
| Gradient generation | Manual color stop math | CSS gradient playground (gradient.style or cssgradient.io) | Iterating in the browser is 10x faster than editing CSS blind |

**Key insight:** This entire phase is pure CSS + minimal React. There is no case for a new npm package.

---

## Common Pitfalls

### Pitfall 1: Accent Color Contrast Failure

**What goes wrong:** Replacing warm white `#fafaf9` (19.8:1 contrast) with a muted blue/teal results in a color that fails WCAG AA (4.5:1 required) — text becomes inaccessible.

**Why it happens:** Muted blues/teals are darker than whites; on a near-black `#0a0a0a` background, blues in the `#4–6xxxxx` range often fall below 4.5:1.

**How to avoid:** Check the candidate accent color with WebAIM contrast checker BEFORE writing it into `@theme`. The accent is used on CTA text (`Button.tsx`), focus rings, and potentially hover states — all require 4.5:1 minimum.

**Warning signs:** Text looks "light enough visually" but may fail automated contrast audit tools.

**Known-safe candidates:**
- `#7a9eb8` (~5.5:1 on #0a0a0a — verify)
- `#6b8fae` (~5.1:1 — verify)
- `#5faabb` — teal variant (~5.3:1 — verify)

Always verify with a tool. Do not rely on visual estimation.

### Pitfall 2: Hero Section Becoming 'use client' — Stagger Animation Break

**What goes wrong:** Adding `'use client'` to `Hero.tsx` for the parallax hook. The Hero currently uses `Button` only — no server data, so this is safe. But if parallax is added to a section that uses `AnimatedSection` (a client component already), there is no issue. The real risk is accidentally converting a server component that fetches data.

**Why it happens:** Not understanding which sections are RSC vs client. In this project, `AnimatedSection` is already `'use client'` and used in all sections except `Hero` and `Intro`.

**How to avoid:** Hero and Intro have no `AnimatedSection` wrapping — they are currently server components. Adding `'use client'` to Hero for parallax is safe and correct. Do NOT add it to sections unless needed.

**Better approach:** Create a separate `ParallaxElement` client component that wraps only the element needing parallax, so the parent section stays as a server component:

```tsx
// components/ui/ParallaxElement.tsx
'use client';
import { useParallax } from '@/lib/hooks/useParallax';
export function ParallaxElement({ children, speed = 0.06, as: Tag = 'div', className }: ...) {
  const ref = useParallax(speed);
  return <Tag ref={ref} className={className}>{children}</Tag>;
}
```

### Pitfall 3: Body Gradient Breaking Existing background-color Classes

**What goes wrong:** Setting `background` shorthand on `body` overrides `background-color`. The layout.tsx sets `className="bg-background"` (Tailwind utility = `background-color: var(--color-background)`). If the CSS `background` shorthand is declared later in the cascade, it will override Tailwind's `bg-background`.

**Why it happens:** `background` shorthand resets all sub-properties including `background-color`.

**How to avoid:** Two safe options:
1. Apply the gradient in `@layer base` on `body` directly (which takes precedence over Tailwind utilities in the same layer since base runs before utilities) — OR
2. Keep `bg-background` on body and put the gradient purely on `body::before` as a `background-image` layer (simplest and safest)

**Recommended:** Option 2 — gradient on `body::before`, solid `background-color` on `body`. Keeps them independent.

### Pitfall 4: Grain Visible as Tile Seams

**What goes wrong:** The SVG noise tile is 600×600 (default viewBox). At small `background-size` values, the tile edges create visible seams — a grid pattern underlying the grain.

**Why it happens:** `feTurbulence` without `stitchTiles='stitch'` does not tile seamlessly.

**How to avoid:** Always include `stitchTiles='stitch'` in the `<feTurbulence>` element (shown in the pattern above). This is already in the recommended code example.

**Warning sign:** Visible grid lines at 45° or horizontal/vertical in the background texture.

### Pitfall 5: Parallax Scroll Causing Layout Shift or Overflow

**What goes wrong:** `translateY` on an element near the top/bottom of its container causes the element to visually overflow, either clipping against the section boundary or creating unwanted whitespace.

**Why it happens:** translateY moves an element without affecting layout flow; if the movement is large enough, the element leaves its container's visible bounds.

**How to avoid:** Keep parallax speed low (0.05–0.1). Apply to headline/text elements rather than full sections. Add `overflow: hidden` to the section container as a safety net if needed.

---

## Code Examples

Verified patterns from official and authoritative sources:

### Defining Custom Background Image in Tailwind v4 @theme
```css
/* Source: https://github.com/tailwindlabs/tailwindcss/discussions/17874 */
/* Source: https://tailwindcss.com/docs/background-image */
@theme {
  --background-image-page-gradient: linear-gradient(
    160deg,
    rgba(255,255,255,0.02) 0%,
    transparent 60%
  );
}
/* Usage: className="bg-page-gradient" */
```

### Adding Custom Tracking Token
```css
/* Source: https://tailwindcss.com/docs/letter-spacing */
@theme {
  --tracking-editorial: -0.035em;
}
/* Usage: className="tracking-editorial" */
```

### Tailwind v4 divide-y for Ruled Lines
```jsx
{/* Source: Tailwind CSS v4 docs — divide utilities */}
<div className="divide-y divide-text-tertiary/20">
  {items.map(item => (
    <div key={item.id} className="py-8 group">
      <h3 className="text-xl mb-2">{item.title}</h3>
      <p className="text-text-secondary group-hover:text-text-primary transition-colors duration-200">
        {item.description}
      </p>
    </div>
  ))}
</div>
```

### CSS mask-image for Photo Edge Fade
```jsx
{/* Source: https://developer.mozilla.org/en-US/docs/Web/CSS/mask-image */}
{/* Source: https://web.dev/articles/css-masking */}
<div
  style={{
    maskImage: 'radial-gradient(ellipse 85% 85% at 50% 40%, black 40%, transparent 80%)',
    WebkitMaskImage: 'radial-gradient(ellipse 85% 85% at 50% 40%, black 40%, transparent 80%)',
  }}
>
  <Image src="/images/profile.jpg" alt="Zach Said" width={200} height={200}
    className="object-cover w-full h-full" />
</div>
```

### Grain Texture SVG Data-URI on Body
```css
/* Source: https://ibelick.com/blog/create-grainy-backgrounds-with-css */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 600'%3E%3Cfilter id='a'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23a)'/%3E%3C/svg%3E");
  background-size: 200px 200px;
  opacity: 0.035;
}
```

### Parallax Hook with rAF and prefers-reduced-motion
```typescript
// lib/hooks/useParallax.ts — complete implementation
'use client';
import { useEffect, useRef } from 'react';

export function useParallax<T extends HTMLElement>(speed: number = 0.08) {
  const ref = useRef<T>(null);

  useEffect(() => {
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

    let rafId: number;
    const onScroll = () => {
      rafId = requestAnimationFrame(() => {
        if (!ref.current) return;
        const rect = ref.current.getBoundingClientRect();
        const center = rect.top + rect.height / 2;
        const offset = (center - window.innerHeight / 2) * speed;
        ref.current.style.transform = `translateY(${offset.toFixed(1)}px)`;
      });
    };

    window.addEventListener('scroll', onScroll, { passive: true });
    onScroll();

    return () => {
      window.removeEventListener('scroll', onScroll);
      cancelAnimationFrame(rafId);
    };
  }, [speed]);

  return ref;
}
```

---

## State of the Art

| Old Approach | Current Approach | Notes |
|--------------|------------------|-------|
| CSS `filter: url(#grain)` on gradient elements | SVG feTurbulence data-URI in `::before` | Data-URI avoids inline SVG in HTML; more portable |
| External PNG noise overlay | SVG feTurbulence data-URI | Zero HTTP request, scalable, tunable |
| CSS scroll-driven animations (`animation-timeline: scroll()`) | JS scroll listener + rAF | CSS version lacks Firefox support as of early 2026; JS is cross-browser |
| `background-image` gradients in Tailwind `extend` config | `--background-image-*` in `@theme` | Tailwind v4 pattern; generates `bg-*` utility directly |
| `tracking-tight` / `tracking-tighter` classes | Custom `--tracking-editorial` token in `@theme` | More semantic, maps to design intent |

**Deprecated/outdated:**
- Tailwind v3 `tailwind.config.js` extend: This project uses v4 `@theme` — do not add anything to a config file.
- `window.scrollY` polyfills: All modern browsers support `window.scrollY` natively.
- `-webkit-mask-image` only: Both `mask-image` and `-webkit-mask-image` should be set in JSX style objects for cross-browser safety.

---

## Current Codebase State (key facts for planning)

This research audited the actual component files. Key facts the planner must know:

**globals.css @theme — current accent:**
```css
--color-accent: #fafaf9; /* warm white — WILL CHANGE */
```
This is consumed by `Button.tsx` (primary variant: `text-accent hover:text-accent/80`) and the `focus-visible` ring in `@layer base`. Changing the token is the right approach — propagates everywhere automatically.

**Headings — current letter-spacing:**
```css
h1, h2, h3, h4, h5, h6 { letter-spacing: -0.02em; }
```
Phase needs tighter tracking specifically on h1 and h2 — override in `@layer base` after the universal rule, or apply class directly in Hero.

**Section dividers in page.tsx — currently invisible:**
```jsx
<hr className="border-t border-text-tertiary/10" />
/* border-text-tertiary = #7a7a7a; at /10 opacity = rgba(122,122,122,0.1) on #0a0a0a — invisible */
```
Fix: Change to `/20` or `/25`.

**Services.tsx and Process.tsx — current spacing:**
```jsx
<div className="space-y-10">
  {items.map(item => <div key={...}>...</div>)}
</div>
```
Replace `space-y-10` with `divide-y divide-text-tertiary/20` and add `py-8` to each item.

**About.tsx photo — current wrapper:**
```jsx
<div className="w-48 h-48 md:w-full md:h-auto rounded-lg overflow-hidden bg-text-tertiary/10">
```
Remove `rounded-lg bg-text-tertiary/10` and add `mask-image` style. The `overflow-hidden` is fine to keep or remove.

**Hero.tsx — currently a server component (no 'use client').**
If parallax is applied to the hero h1, either:
(a) Add `'use client'` to Hero.tsx — safe since Hero has no server data
(b) Wrap only the h1 in a `<ParallaxElement>` client component

**AnimatedSection.tsx — already `'use client'`** — sections using it are already client-rendered.

---

## Open Questions

1. **Exact accent color shade**
   - What we know: Must be a cool muted blue or teal; must achieve ≥4.5:1 contrast on #0a0a0a; candidates include ~#7a9eb8, #6b8fae, #5faabb
   - What's unclear: Which reads best against the existing warm-white primary text and #7a7a7a tertiary text in context
   - Recommendation: Pick 2–3 candidates, render in browser against real content, verify contrast with WebAIM tool, commit the winner

2. **Gradient stops for background depth**
   - What we know: Radial-gradient spotlight + linear directional shift; "Refined but visible" level of subtlety
   - What's unclear: Exact color stops, angle, ellipse size — must be tuned visually
   - Recommendation: Start with the example in Pattern 1 above (0.03 opacity radial highlight + subtle linear), iterate in browser

3. **Parallax element scope**
   - What we know: "Some elements move at different scroll speeds for depth" — locked decision
   - What's unclear: Whether this means hero h1 only, or also section-level elements
   - Recommendation: Implement on hero h1 first; evaluate in browser; add 1 more element (e.g. hero subtext at different speed) if it looks right

4. **Grain intensity**
   - What we know: "Refined but visible" refinement level
   - What's unclear: Exact opacity — depends on monitor calibration and final gradient colors
   - Recommendation: Start at `opacity: 0.035` on the `::before`, adjust between 0.025–0.05 by eye

---

## Sources

### Primary (HIGH confidence)
- https://tailwindcss.com/docs/letter-spacing — Tailwind v4 tracking values and @theme custom tracking
- https://tailwindcss.com/docs/background-image — bg-image utility and @theme --background-image-* pattern
- https://github.com/tailwindlabs/tailwindcss/discussions/17874 — confirmed @theme gradient syntax
- https://developer.mozilla.org/en-US/docs/Web/CSS/mask-image — mask-image CSS property
- https://web.dev/articles/css-masking — CSS masking practical guide
- https://developer.mozilla.org/en-US/docs/Web/CSS/Guides/Scroll-driven_animations — scroll-driven animation browser support status

### Secondary (MEDIUM confidence)
- https://ibelick.com/blog/create-grainy-backgrounds-with-css — SVG feTurbulence data-URI pseudo-element pattern (verified technique, multiple corroborating sources)
- https://frontendmasters.com/blog/grainy-gradients/ — feTurbulence parameters and displacement map variant
- https://css-tricks.com/bringing-back-parallax-with-scroll-driven-css-animations/ — CSS scroll-driven parallax (confirms Firefox gap, progressive enhancement approach)
- https://medium.com/@dhg/parallax-done-right-82ced812e61c — rAF + passive scroll listener parallax pattern

### Tertiary (LOW confidence)
- WebSearch results on letter-spacing editorial design — general guidance, not from official docs
- WebSearch results on WCAG contrast for muted blue/teal — contrast ratios quoted are estimates, MUST verify with contrast tool before committing

---

## Metadata

**Confidence breakdown:**
- Standard stack: HIGH — no new dependencies; all techniques use already-installed tools
- Architecture: HIGH — direct codebase audit confirms existing component structure; edits are surgical
- Grain texture: HIGH — SVG feTurbulence technique is well-documented and production-proven
- Parallax approach: MEDIUM — recommendation (JS + rAF) is solid; CSS scroll-driven alternative flagged as limited browser support
- Accent color contrast: LOW until verified — specific hex values quoted are estimates; must use contrast tool before committing
- Pitfalls: HIGH — all identified pitfalls come from direct codebase analysis or authoritative CSS sources

**Research date:** 2026-02-17
**Valid until:** 2026-04-17 (CSS techniques are stable; Tailwind v4 API is stable; only Firefox scroll-driven animation support might change)
