---
phase: 03.1-visual-polish-styling
plan: 03
type: execute
wave: 3
depends_on: ["03.1-02"]
files_modified:
  - lib/hooks/useParallax.ts
  - components/sections/Hero.tsx
autonomous: false
requirements:
  - ANIM-01
  - ANIM-03

must_haves:
  truths:
    - "Hero headline moves at a different scroll speed than surrounding content (parallax depth effect)"
    - "Parallax effect is disabled when user has prefers-reduced-motion enabled"
    - "Parallax uses requestAnimationFrame for smooth 60fps performance"
    - "Site builds and exports successfully as static site"
  artifacts:
    - path: "lib/hooks/useParallax.ts"
      provides: "Reusable parallax scroll hook with prefers-reduced-motion support"
      contains: "useParallax"
    - path: "components/sections/Hero.tsx"
      provides: "Hero with parallax-enabled headline"
      contains: "useParallax"
  key_links:
    - from: "components/sections/Hero.tsx"
      to: "lib/hooks/useParallax.ts"
      via: "Import and ref attachment on h1 element"
      pattern: "useParallax.*ref"
    - from: "lib/hooks/useParallax.ts"
      to: "window.matchMedia"
      via: "prefers-reduced-motion check"
      pattern: "prefers-reduced-motion"
---

<objective>
Create the parallax-lite scroll hook and wire it to the Hero headline, then verify the complete visual polish pass with a human checkpoint.

Purpose: Parallax adds the final depth layer — elements moving at different scroll speeds creates a sense of visual sophistication. The checkpoint ensures the cumulative effect of all three plans (background, component edits, parallax) delivers the intended editorial magazine feel.

Output: New useParallax hook, updated Hero.tsx with parallax, visual verification checkpoint.
</objective>

<execution_context>
@/Users/zachsaid/.claude/get-shit-done/workflows/execute-plan.md
@/Users/zachsaid/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03.1-visual-polish-styling/03.1-RESEARCH.md
@.planning/phases/03.1-visual-polish-styling/03.1-01-SUMMARY.md
@.planning/phases/03.1-visual-polish-styling/03.1-02-SUMMARY.md
@components/sections/Hero.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create useParallax hook and wire to Hero headline</name>
  <files>lib/hooks/useParallax.ts, components/sections/Hero.tsx</files>
  <action>
**Create `lib/hooks/useParallax.ts`:**

Create a new file at `lib/hooks/useParallax.ts`. This is a lightweight React hook that applies `translateY` parallax to a ref'd element based on scroll position.

```typescript
'use client';

import { useEffect, useRef } from 'react';

/**
 * Applies a subtle translateY parallax to the ref'd element.
 * speed: 0.0 = no movement, 0.1 = very subtle, 0.2 = noticeable
 * Automatically disabled when prefers-reduced-motion is set.
 */
export function useParallax<T extends HTMLElement>(speed: number = 0.08) {
  const ref = useRef<T>(null);

  useEffect(() => {
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (prefersReduced) return;

    let rafId: number;

    const onScroll = () => {
      rafId = requestAnimationFrame(() => {
        if (!ref.current) return;
        const rect = ref.current.getBoundingClientRect();
        const center = rect.top + rect.height / 2;
        const offset = (center - window.innerHeight / 2) * speed;
        ref.current.style.transform = `translateY(${offset.toFixed(1)}px)`;
      });
    };

    window.addEventListener('scroll', onScroll, { passive: true });
    onScroll(); // initial position

    return () => {
      window.removeEventListener('scroll', onScroll);
      cancelAnimationFrame(rafId);
    };
  }, [speed]);

  return ref;
}
```

Key implementation details:
- `'use client'` directive — required for hooks using browser APIs
- `{ passive: true }` on the scroll listener — prevents scroll-blocking for smooth performance
- `requestAnimationFrame` batches repaints — keeps transform updates at 60fps
- `prefers-reduced-motion: reduce` check — per locked decision ANIM-03, all non-essential animations must be disabled
- Speed of `0.08` default is very subtle — elements shift ~8% of the distance from viewport center
- Uses `getBoundingClientRect()` for current position — no stored scroll offset needed
- Cleanup removes listener and cancels pending rAF

**Update `components/sections/Hero.tsx`:**

Add `'use client'` directive (required for using the hook). Import and use `useParallax` on the h1 element with a speed of `0.06` (very subtle, slightly slower than default).

Updated Hero.tsx:
```tsx
'use client';

import { Button } from '@/components/ui';
import { useParallax } from '@/lib/hooks/useParallax';

export function Hero() {
  const headlineRef = useParallax<HTMLHeadingElement>(0.06);

  return (
    <section className="min-h-[70vh] flex items-center section-padding">
      <div className="prose-width">
        <p className="section-label mb-8">Mira Consultancy</p>
        <h1 ref={headlineRef} className="mb-6 font-bold">
          I build the tools your business actually needs.
        </h1>
        <p className="text-lg text-text-secondary max-w-[38rem] mb-8">
          Custom applications, AI agents, and workflow automation — built with
          precision for businesses that need to move fast.
        </p>
        <Button href="https://calendly.com/placeholder" external>
          Let&apos;s talk
        </Button>
      </div>
    </section>
  );
}
```

Key changes:
- Added `'use client'` at top — safe because Hero has no server data (no fetch, no async)
- Imported `useParallax` from `@/lib/hooks/useParallax`
- Called `useParallax<HTMLHeadingElement>(0.06)` — speed 0.06 is very subtle
- Added `ref={headlineRef}` to the `<h1>` element
- Kept `font-bold` class from Plan 02

**What NOT to do:**
- Do NOT apply parallax to more than the hero h1 in this plan — keep scope minimal ("parallax-lite")
- Do NOT use a speed higher than 0.1 — higher values cause visible layout shift and visual chaos
- Do NOT add `overflow: hidden` to the hero section unless parallax causes visible overflow issues
- Do NOT add any additional npm packages — this is pure React + browser APIs
  </action>
  <verify>
Run `npm run build` — build must succeed with static export.
Verify `lib/hooks/useParallax.ts` exists and contains `useParallax`.
Verify `components/sections/Hero.tsx` contains `'use client'`, `useParallax`, and `ref={headlineRef}`.
Run `npm run dev` and scroll the page — the h1 should shift subtly relative to surrounding content.
  </verify>
  <done>
useParallax hook exists at lib/hooks/useParallax.ts. Hero.tsx imports the hook and applies parallax to the h1 element with speed 0.06. Parallax is disabled when prefers-reduced-motion is set. Build succeeds.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Visual verification of complete visual polish</name>
  <files>app/globals.css, app/page.tsx, components/sections/Hero.tsx, components/sections/Services.tsx, components/sections/Process.tsx, components/sections/About.tsx, lib/hooks/useParallax.ts</files>
  <action>
Human verification of the complete visual polish pass across the entire site. What was built:
1. Background depth — Gradient base with film grain texture overlay (body + body::before)
2. Accent color — Muted blue/teal replacing warm white for CTAs and focus rings
3. Typography — Tighter tracking on h1/h2, larger + bolder hero headline (5xl, 700 weight)
4. Section dividers — Visible at /20 opacity (up from invisible /10)
5. Ruled lines — Magazine-style horizontal lines between service and process items
6. Hover states — Description text brightens on hover in services and process sections
7. Photo fade — About section photo edges dissolve into the background via CSS mask
8. Parallax — Hero headline moves at a slightly different scroll speed for depth
  </action>
  <verify>
1. Run `npm run dev` and open http://localhost:3000 in the browser
2. Background check: Look at the overall page background — it should show subtle gradient depth (slightly lighter near top-left) with a fine grain/noise texture visible on close inspection. The grain should be static (not animated).
3. Hero check: The headline should be noticeably larger and bolder than before. When you scroll, the headline should move at a slightly different speed than surrounding elements (very subtle parallax).
4. Accent color check: The "Let's talk" CTA link should display in a muted blue/teal color (not warm white). The arrow should also be this color.
5. Section dividers: Scroll down — thin horizontal lines should be visible between each section.
6. Services section: Items separated by thin horizontal ruled lines. Hover over a service item — description text brightens, heading stays unchanged.
7. Process section: Same as Services — ruled lines between steps, description brightens on hover.
8. About section: Profile photo edges fade/dissolve into the dark background.
9. Mobile check: Resize browser to 375px width — verify nothing is broken.
10. Reduced motion: In Chrome DevTools Rendering, check "Emulate CSS prefers-reduced-motion: reduce" — parallax should be disabled.

Resume signal: Type "approved" if the visual direction lands, or describe specific issues to adjust.
  </verify>
  <done>
Human approves the cumulative visual direction — background depth, accent color, typography, ruled lines, photo fade, hover states, and parallax all look correct and cohesive.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes successfully (static export)
2. `lib/hooks/useParallax.ts` exists with prefers-reduced-motion check
3. `components/sections/Hero.tsx` uses `'use client'` and imports useParallax
4. Hero h1 has parallax ref attached
5. Parallax speed is subtle (0.06)
6. Human verifies the complete visual polish pass looks correct
</verification>

<success_criteria>
- Hero headline exhibits subtle parallax depth effect on scroll
- Parallax is disabled with prefers-reduced-motion
- Human approves the cumulative visual direction (all 3 plans combined)
- Build passes, static export works
- No new npm packages added
</success_criteria>

<output>
After completion, create `.planning/phases/03.1-visual-polish-styling/03.1-03-SUMMARY.md`
</output>
